# -*- coding: utf-8 -*-
"""LVADSUSR107_snehith.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/175ycCMiq9c8Hz2Ktieu8nt0Rb5h0gTRy
"""

#1
import pandas as pd
df=pd.read_excel('/content/Walmart_Dataset Python_Final_Assessment.xlsx')
a=df.head()
print(a)
b=df.columns
print(b)
c=df.astype
print(c)
df.describe()



#2\
missing_values = df.isnull().sum()
print(missing_values)

df.dropna(inplace=True)

df.fillna(value=0, inplace=True)

import pandas as pd
df=pd.read_excel('/content/Walmart_Dataset Python_Final_Assessment.xlsx')
df.duplicated('Order ID').count()
#display(df.drop_duplicates())

#3
mean_median_std_var=df.groupby('Category')['Sales'].agg(['mean','median','std','var'])
print(mean_median_std_var)
print('*******************************')
mode=df['Quantity'].mode()
print(mode)
df['Sales'].range()

import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd

import matplotlib.pyplot as plt

#pie chart
data = df.groupby('Category')['Sales'].sum().reset_index().rename(columns={'sales':'Sales'})
fig_data = data[0:20]
plt.figure(figsize= (10,8))
plt.pie(fig_data['Sales'], labels=fig_data['Category'], autopct='%0.1f%%')
plt.title("PIECHART")
plt.legend()

import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd
import matplotlib.pyplot as plt
#box plot

data1 = df.groupby('Category')['Sales'].sum().reset_index().rename(columns={'sales':'Sales'})
fig_data1 = data[0:20]
sns.boxplot(data1)
plt.title('BOXPLOT')
plt.show()

import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd

#Bar graph
data1 = df.groupby('Category')['Sales'].sum().reset_index().rename(columns={'sales':'Sales'})
fig_data1 = data1[0:50]
plt.bar(fig_data1['Category'],fig_data1['Sales'])
plt.xticks(rotation=45)
plt.title("BAR GRAPH")

import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd

#LINE graph
data2 = df.groupby('Order Date')['Order ID'].count().reset_index().rename(columns={'sales':'Sales'})

fig_data2 = data1[0:50]
plt.plot(fig_data2['Order Date'],fig_data2['Order ID'],marker='o',color='black')
plt.xticks(rotation=45)
plt.title("LINE GRAPH")
plt.ylabel("number of orders")
plt.xlabel("dates")

import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd

#histogram
data3 = df.groupby('Order Date')['Order ID'].count().reset_index().rename(columns={'sales':'Sales'})

data3['Order ID'].plot(kind='hist', bins=20, title='Order ID')

import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd
plt.figure(figsize=(10, 6))
plt.scatter(df['Sales'], df['Profit'], df['Quantity'], alpha=0.5, cmap='viridis')

plt.grid(True)
plt.show()

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
df=pd.read_excel('/content/Walmart_Dataset Python_Final_Assessment.xlsx')
corr=df.corr()
sns.heatmap(corr)
plt.legend()
plt.title("CORREALTION HEAT MAP")

#6
fig_data4 = df[0:50]
sns.boxplot(fig_data4)
plt.title("boxplot to find outliners")

#7
#(i)

df['Order Date'] = pd.to_datetime(df['Order Date'])
df['Year'] = df['Order Date'].dt.year
monthly_data = df.groupby('Year').agg({'Sales': 'sum', 'Profit': 'sum'})

monthly_data.plot(kind='bar', figsize=(10, 6))
plt.title('Monthly Sales and Profits')
plt.xlabel('YEAR')
plt.ylabel('Amount')
plt.xticks(rotation=0)
plt.legend(['Sales', 'Profits'])
plt.show()

#7(ii)
df['Order Date'] = pd.to_datetime(df['Order Date'])
df['Year'] = df['Order Date'].dt.year
c=df.groupby(['Year','Category']).agg({'Sales': 'sum'})
c
c['Sales'].plot(kind='line', figsize=(8, 4), title='Sales')
plt.xticks(rotation=45)
plt.title("yearly trend of category sales")
plt.ylabel("sales")

#7
(3)
a=df.groupby('EmailID').agg({'Order ID':'count','Sales':'sum'})
print(a)
b=a[a['Order ID']==a['Order ID'].max()]
b

#7(4)
a=df.groupby('EmailID')

#7
#(5)
Use historical sales velocity data to forecast demand accurately.
Advanced forecasting methods, including machine learning algorithms,can help in predicting future demand patterns more accurately.
 Analyze sales velocity data to identify fast-moving and slow-moving items. Implement just-in-time (JIT) inventory management for fast-moving items to minimize inventory holding costs, while ensuring buffer stock for slow-moving items.

#7(6)
the factors contribute to the geographic sales,Geographic segmentation variables. Pricing, product availability, and marketing tactics are just some of the things that depend on where an organization is located

#7(7)
we can identify the pattern or predictors of high value  customers from the purchase behaviour  ad calculating the average gap between orders and provide
them with offers and make them habituated to the mart.we can identify the top 50 customers and provide them with life time membership